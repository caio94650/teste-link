<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Compatibility near you</title>
<style>
  :root{--bg:#f7f8fb;--card:#ffffff;--txt:#1b2330;--muted:#708099;--brand:#2563eb;--brand2:#1e40af;--ok:#16a34a}
  *{box-sizing:border-box}body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,"Noto Sans",sans-serif;background:var(--bg);color:var(--txt)}
  .wrap{max-width:440px;margin:0 auto;min-height:100dvh;display:flex;align-items:center;justify-content:center;padding:18px}
  .card{background:var(--card);width:100%;border-radius:20px;box-shadow:0 10px 30px rgba(2,6,23,.08);padding:22px}
  .brand{display:flex;gap:10px;align-items:center;margin-bottom:8px}
  .brand-dot{width:10px;height:10px;border-radius:50%;background:var(--brand)}
  h1{font-size:22px;line-height:1.25;margin:6px 0 12px}
  p{color:var(--muted);margin:0 0 14px}
  .progress{height:8px;background:#e9edf3;border-radius:999px;overflow:hidden;margin:10px 0 16px}
  .bar{height:100%;width:0;background:var(--brand);transition:width .35s ease}
  .q-img{width:100%;border-radius:14px;margin:10px 0}
  .grid{display:grid;gap:10px}
  .grid-2{grid-template-columns:1fr 1fr}
  .btn{appearance:none;border:0;border-radius:12px;background:#eef3f8;color:var(--txt);padding:14px 12px;font-weight:600;cursor:pointer}
  .btn:hover{filter:brightness(.98)}
  .btn.brand{background:var(--brand);color:#fff}
  .btn.brand:hover{background:var(--brand2)}
  .btn.ghost{background:#fff;border:1px solid #e6e9f0}
  .muted{font-size:12px;color:#96a3b6}.center{text-align:center}
  .pill{display:inline-flex;gap:6px;align-items:center;background:#f1f5fb;color:#3c4a5f;border-radius:999px;padding:6px 10px;font-size:12px;font-weight:600}
  .loader{display:inline-block;width:10px;height:10px;border:2px solid #c8d2e3;border-top-color:var(--brand);border-radius:50%;animation:spin .9s linear infinite}
  @keyframes spin{to{transform:rotate(360deg)}}
  .hidden{display:none}.found{color:var(--ok);font-weight:700}
  footer{margin-top:14px}a.clean{color:inherit}
</style>
</head>
<body>
<div class="wrap">
  <div class="card" id="app" dir="ltr">
    <div class="brand"><span class="brand-dot"></span><span class="pill" id="i_badge">Compatibility â€¢ Step-by-step</span></div>
    <h1 id="title">Profiles near <span id="loc-inline">you</span></h1>
    <p id="subtitle">Answer 3 quick questions to find compatible people in <span id="loc-sub">your area</span>.</p>

    <div class="progress"><div class="bar" id="bar"></div></div>

    <img src="https://i.ibb.co/3sZ9dXx/casal-feliz.jpg" alt="Happy people" class="q-img" id="qimg">

    <!-- STEP 1 -->
    <section id="step1" class="grid grid-2">
      <button class="btn" onclick="choose('gender','Male')" id="b_male">Iâ€™m Male</button>
      <button class="btn" onclick="choose('gender','Female')" id="b_female">Iâ€™m Female</button>
    </section>

    <!-- STEP 2 -->
    <section id="step2" class="grid grid-2 hidden">
      <button class="btn" onclick="choose('seeking','Men')" id="b_seek_men">Looking for Men</button>
      <button class="btn" onclick="choose('seeking','Women')" id="b_seek_women">Looking for Women</button>
      <button class="btn" onclick="choose('seeking','Both')" id="b_seek_both">Both</button>
      <button class="btn ghost" onclick="choose('seeking','Prefer not to say')" id="b_seek_notsay">Prefer not to say</button>
    </section>

    <!-- STEP 3 -->
    <section id="step3" class="grid grid-2 hidden">
      <button class="btn" onclick="choose('age','18-25')">18â€“25</button>
      <button class="btn" onclick="choose('age','26-35')">26â€“35</button>
      <button class="btn" onclick="choose('age','36-45')">36â€“45</button>
      <button class="btn" onclick="choose('age','46+')">46+</button>
    </section>

    <!-- STEP 4 -->
    <section id="step4" class="grid grid-2 hidden">
      <button class="btn" onclick="choose('goal','Serious relationship')" id="b_goal_serious">Serious relationship</button>
      <button class="btn" onclick="choose('goal','Casual dates')" id="b_goal_casual">Casual dates</button>
      <button class="btn" onclick="choose('goal','Friendship')" id="b_goal_friend">Friendship</button>
      <button class="btn ghost" onclick="choose('goal','Undecided')" id="b_goal_undecided">Undecided</button>
    </section>

    <!-- LOADING -->
    <section id="scan" class="hidden center">
      <p class="pill"><span class="loader"></span> <span id="i_scanning">Analyzing answersâ€¦</span></p>
      <p class="muted" id="i_scan_sub">Filtering nearby profiles based on your preferences in <span id="loc-scan">your area</span>.</p>
      <img src="https://i.ibb.co/zV1xhvN/chat-sedutor.jpg" alt="Searching" class="q-img">
      <div id="scanStatus" class="muted">Searching matchesâ€¦ 0%</div>
    </section>

    <!-- RESULT -->
    <section id="result" class="hidden">
      <h2 class="found" id="i_found">âœ” We found 7 highly compatible profiles in <span id="loc-result">your area</span></h2>
      <p id="summary">Based on your answers, we selected people that match you.</p>
      <ul class="muted" id="bullets" style="padding-left:18px;margin:10px 0 0">
        <li id="i_b1">Verified profiles with shared interests</li>
        <li id="i_b2">Discreet and safe chat</li>
        <li id="i_b3">Free sign-up for new members</li>
      </ul>
      <div class="grid" style="margin-top:14px">
        <a id="cta" class="btn brand center" href="SUA_URL_AQUI">ðŸ‘‰ <span id="i_cta">See my compatible profiles</span></a>
        <button class="btn ghost" onclick="restart()" id="i_restart">Retake quiz</button>
      </div>
      <p class="muted center" style="margin-top:10px" id="i_slots">Local spots update in real time â€” may sell out.</p>
    </section>

    <footer>
      <p class="muted" id="i_footer">
        Informational/entertainment content. No explicit material displayed. By proceeding, you agree to our 
        <a class="clean" href="#" onclick="alert('Basic terms: informational content, no guarantees of results.');return false;">Terms</a>.
      </p>
    </footer>
  </div>
</div>

<script>
/* ========================
   STATE
======================== */
const state = { gender:null, seeking:null, age:null, goal:null, step:1, total:6, city:null, region:null, country:null, cc:null, lang:'en' };
const el = s => document.querySelector(s);
const show = id => el(id).classList.remove('hidden');
const hide = id => el(id).classList.add('hidden');

const L = {
  en:{
    badge:"Compatibility â€¢ Step-by-step",
    t1:loc=>`Profiles near ${loc||'you'}`,
    s1:loc=>`Answer 3 quick questions to find compatible people in ${loc||'your area'}.`,
    t2:"Who do you want to meet?", s2:"This helps us show only people you're interested in.",
    t3:"Which age range interests you?", s3:"You can adjust later if you want.",
    t4:"What are you looking for now?", s4:"No judgments â€” choose what makes sense for you.",
    scanning:"Analyzing answersâ€¦",
    scanSub:loc=>`Filtering nearby profiles based on your preferences in ${loc||'your area'}.`,
    found:loc=>`âœ” We found 7 highly compatible profiles in ${loc||'your area'}`,
    b1:"Verified profiles with shared interests",
    b2:"Discreet and safe chat",
    b3:"Free sign-up for new members",
    cta:"See my compatible profiles",
    restart:"Retake quiz",
    slots:"Local spots update in real time â€” may sell out",
    male:"Iâ€™m Male", female:"Iâ€™m Female",
    seek_men:"Looking for Men", seek_women:"Looking for Women", seek_both:"Both", seek_notsay:"Prefer not to say",
    goal_serious:"Serious relationship", goal_casual:"Casual dates", goal_friend:"Friendship", goal_und:"Undecided",
    footer:"Informational/entertainment content. No explicit material displayed. By proceeding, you agree to our Terms."
  },
  pt:{
    badge:"Compatibilidade â€¢ Passo a passo",
    t1:loc=>`Perfis prÃ³ximos de ${loc||'vocÃª'}`,
    s1:loc=>`Responda 3 perguntas rÃ¡pidas para encontrar pessoas compatÃ­veis em ${loc||'sua regiÃ£o'}.`,
    t2:"Quem vocÃª quer conhecer?", s2:"Isso ajuda a mostrar apenas pessoas do seu interesse.",
    t3:"Qual faixa etÃ¡ria te interessa?", s3:"VocÃª pode ajustar depois, se quiser.",
    t4:"O que vocÃª busca agora?", s4:"Sem julgamentos â€” escolha o que faz sentido pra vocÃª.",
    scanning:"Analisando respostasâ€¦",
    scanSub:loc=>`Filtrando perfis prÃ³ximos de ${loc||'vocÃª'} com base nas suas preferÃªncias.`,
    found:loc=>`âœ” Encontramos 7 perfis com alta compatibilidade em ${loc||'sua regiÃ£o'}`,
    b1:"Perfis verificados e com interesses em comum",
    b2:"Chat discreto e seguro",
    b3:"InscriÃ§Ã£o gratuita para novos membros",
    cta:"Ver meus perfis compatÃ­veis",
    restart:"Refazer quiz",
    slots:"Vagas locais atualizam em tempo real â€” pode esgotar",
    male:"Sou Homem", female:"Sou Mulher",
    seek_men:"Procuro Homens", seek_women:"Procuro Mulheres", seek_both:"Ambos", seek_notsay:"Prefiro nÃ£o dizer",
    goal_serious:"Relacionamento sÃ©rio", goal_casual:"Encontros casuais", goal_friend:"Amizade", goal_und:"Indefinido",
    footer:"ConteÃºdo de entretenimento/informativo. NÃ£o exibimos material explÃ­cito. Ao prosseguir, vocÃª concorda com nossos Termos."
  },
  /* Danish (DK) */
  da:{
    badge:"Kompatibilitet â€¢ Trin for trin",
    t1:loc=>`Profiler i nÃ¦rheden af ${loc||'dig'}`,
    s1:loc=>`Svar pÃ¥ 3 hurtige spÃ¸rgsmÃ¥l for at finde kompatible personer i ${loc||'dit omrÃ¥de'}.`,
    t2:"Hvem vil du mÃ¸de?", s2:"Det hjÃ¦lper os med kun at vise relevante personer.",
    t3:"Hvilken aldersgruppe interesserer dig?", s3:"Du kan justere det senere, hvis du vil.",
    t4:"Hvad sÃ¸ger du nu?", s4:"Ingen dom â€” vÃ¦lg det, der passer til dig.",
    scanning:"Analyserer svarâ€¦",
    scanSub:loc=>`Filtrerer nÃ¦rliggende profiler baseret pÃ¥ dine prÃ¦ferencer i ${loc||'dit omrÃ¥de'}.`,
    found:loc=>`âœ” Vi fandt 7 meget kompatible profiler i ${loc||'dit omrÃ¥de'}`,
    b1:"Verificerede profiler med fÃ¦lles interesser",
    b2:"Diskret og sikker chat",
    b3:"Gratis tilmelding for nye medlemmer",
    cta:"Se mine kompatible profiler",
    restart:"Tag quizzen igen",
    slots:"Lokale pladser opdateres i realtid â€” kan blive udsolgt",
    male:"Jeg er mand", female:"Jeg er kvinde",
    seek_men:"Jeg sÃ¸ger mÃ¦nd", seek_women:"Jeg sÃ¸ger kvinder", seek_both:"Begge", seek_notsay:"Vil ikke sige",
    goal_serious:"SeriÃ¸st forhold", goal_casual:"Uforpligtende mÃ¸der", goal_friend:"Venskab", goal_und:"Uafklaret",
    footer:"Informations-/underholdningsindhold. Intet eksplicit materiale. Ved at fortsÃ¦tte accepterer du vores vilkÃ¥r."
  },
  /* Norwegian BokmÃ¥l (NO) */
  nb:{
    badge:"Kompatibilitet â€¢ Trinn for trinn",
    t1:loc=>`Profiler nÃ¦r ${loc||'deg'}`,
    s1:loc=>`Svar pÃ¥ 3 raske spÃ¸rsmÃ¥l for Ã¥ finne kompatible personer i ${loc||'omrÃ¥det ditt'}.`,
    t2:"Hvem vil du mÃ¸te?", s2:"Dette hjelper oss Ã¥ vise bare relevante personer.",
    t3:"Hvilken aldersgruppe interesserer deg?", s3:"Du kan endre det senere om du vil.",
    t4:"Hva ser du etter nÃ¥?", s4:"Ingen dÃ¸mming â€” velg det som passer for deg.",
    scanning:"Analyserer svarâ€¦",
    scanSub:loc=>`Filtrerer nÃ¦rliggende profiler basert pÃ¥ preferansene dine i ${loc||'omrÃ¥det ditt'}.`,
    found:loc=>`âœ” Vi fant 7 svÃ¦rt kompatible profiler i ${loc||'omrÃ¥det ditt'}`,
    b1:"Verifiserte profiler med felles interesser",
    b2:"Diskret og trygg chat",
    b3:"Gratis registrering for nye brukere",
    cta:"Se mine kompatible profiler",
    restart:"Ta testen pÃ¥ nytt",
    slots:"Lokale plasser oppdateres i sanntid â€” kan bli utsolgt",
    male:"Jeg er mann", female:"Jeg er kvinne",
    seek_men:"Ser etter menn", seek_women:"Ser etter kvinner", seek_both:"Begge", seek_notsay:"Vil ikke si",
    goal_serious:"SeriÃ¸st forhold", goal_casual:"Uforpliktende mÃ¸ter", goal_friend:"Vennskap", goal_und:"Ubestemt",
    footer:"Informasjons-/underholdningsinnhold. Ingen eksplisitt materiale. Ved Ã¥ fortsette godtar du vÃ¥re vilkÃ¥r."
  },
  /* Ukrainian (UA) */
  uk:{
    badge:"Ð¡ÑƒÐ¼Ñ–ÑÐ½Ñ–ÑÑ‚ÑŒ â€¢ ÐšÑ€Ð¾Ðº Ð·Ð° ÐºÑ€Ð¾ÐºÐ¾Ð¼",
    t1:loc=>`ÐŸÑ€Ð¾Ñ„Ñ–Ð»Ñ– Ð¿Ð¾Ñ€ÑƒÑ‡ Ñ–Ð· ${loc||'Ð²Ð°Ð¼Ð¸'}`,
    s1:loc=>`Ð”Ð°Ð¹Ñ‚Ðµ 3 ÑˆÐ²Ð¸Ð´ÐºÑ– Ð²Ñ–Ð´Ð¿Ð¾Ð²Ñ–Ð´Ñ–, Ñ‰Ð¾Ð± Ð·Ð½Ð°Ð¹Ñ‚Ð¸ ÑÑƒÐ¼Ñ–ÑÐ½Ð¸Ñ… Ð»ÑŽÐ´ÐµÐ¹ Ñƒ ${loc||'Ð²Ð°ÑˆÐ¾Ð¼Ñƒ Ñ€Ð°Ð¹Ð¾Ð½Ñ–'}.`,
    t2:"ÐšÐ¾Ð³Ð¾ Ð²Ð¸ Ñ…Ð¾Ñ‡ÐµÑ‚Ðµ Ð·ÑƒÑÑ‚Ñ€Ñ–Ñ‚Ð¸?", s2:"Ð¦Ðµ Ð´Ð¾Ð¿Ð¾Ð¼Ð¾Ð¶Ðµ Ð¿Ð¾ÐºÐ°Ð·ÑƒÐ²Ð°Ñ‚Ð¸ Ð»Ð¸ÑˆÐµ Ñ‚Ð¸Ñ…, Ñ…Ñ‚Ð¾ Ð²Ð°Ð¼ Ð¿Ñ–Ð´Ñ…Ð¾Ð´Ð¸Ñ‚ÑŒ.",
    t3:"Ð¯ÐºÐ° Ð²Ñ–ÐºÐ¾Ð²Ð° Ð³Ñ€ÑƒÐ¿Ð° Ð²Ð°Ñ Ñ†Ñ–ÐºÐ°Ð²Ð¸Ñ‚ÑŒ?", s3:"Ð—Ð° Ð¿Ð¾Ñ‚Ñ€ÐµÐ±Ð¸ Ð¼Ð¾Ð¶Ð½Ð° Ð·Ð¼Ñ–Ð½Ð¸Ñ‚Ð¸ Ð¿Ñ–Ð·Ð½Ñ–ÑˆÐµ.",
    t4:"Ð©Ð¾ Ð²Ð¸ ÑˆÑƒÐºÐ°Ñ”Ñ‚Ðµ Ð·Ð°Ñ€Ð°Ð·?", s4:"Ð‘ÐµÐ· Ð¾ÑÑƒÐ´Ñƒ â€” Ð¾Ð±ÐµÑ€Ñ–Ñ‚ÑŒ Ñ‚Ðµ, Ñ‰Ð¾ Ð²Ð°Ð¼ Ð¿Ñ–Ð´Ñ…Ð¾Ð´Ð¸Ñ‚ÑŒ.",
    scanning:"ÐÐ½Ð°Ð»Ñ–Ð·ÑƒÑ”Ð¼Ð¾ Ð²Ñ–Ð´Ð¿Ð¾Ð²Ñ–Ð´Ñ–â€¦",
    scanSub:loc=>`Ð¤Ñ–Ð»ÑŒÑ‚Ñ€ÑƒÑ”Ð¼Ð¾ Ð½Ð°Ð¹Ð±Ð»Ð¸Ð¶Ñ‡Ñ– Ð¿Ñ€Ð¾Ñ„Ñ–Ð»Ñ– Ð·Ð° Ð²Ð°ÑˆÐ¸Ð¼Ð¸ Ð²Ð¿Ð¾Ð´Ð¾Ð±Ð°Ð½Ð½ÑÐ¼Ð¸ Ñƒ ${loc||'Ð²Ð°ÑˆÐ¾Ð¼Ñƒ Ñ€Ð°Ð¹Ð¾Ð½Ñ–'}.`,
    found:loc=>`âœ” ÐœÐ¸ Ð·Ð½Ð°Ð¹ÑˆÐ»Ð¸ 7 Ð´ÑƒÐ¶Ðµ ÑÑƒÐ¼Ñ–ÑÐ½Ð¸Ñ… Ð¿Ñ€Ð¾Ñ„Ñ–Ð»Ñ–Ð² Ñƒ ${loc||'Ð²Ð°ÑˆÐ¾Ð¼Ñƒ Ñ€Ð°Ð¹Ð¾Ð½Ñ–'}`,
    b1:"ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€ÐµÐ½Ñ– Ð¿Ñ€Ð¾Ñ„Ñ–Ð»Ñ– Ð·Ñ– ÑÐ¿Ñ–Ð»ÑŒÐ½Ð¸Ð¼Ð¸ Ñ–Ð½Ñ‚ÐµÑ€ÐµÑÐ°Ð¼Ð¸",
    b2:"Ð”Ð¸ÑÐºÑ€ÐµÑ‚Ð½Ð¸Ð¹ Ñ– Ð±ÐµÐ·Ð¿ÐµÑ‡Ð½Ð¸Ð¹ Ñ‡Ð°Ñ‚",
    b3:"Ð‘ÐµÐ·ÐºÐ¾ÑˆÑ‚Ð¾Ð²Ð½Ð° Ñ€ÐµÑ”ÑÑ‚Ñ€Ð°Ñ†Ñ–Ñ Ð´Ð»Ñ Ð½Ð¾Ð²Ð¸Ñ… ÐºÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡Ñ–Ð²",
    cta:"ÐŸÐµÑ€ÐµÐ³Ð»ÑÐ½ÑƒÑ‚Ð¸ ÑÑƒÐ¼Ñ–ÑÐ½Ñ– Ð¿Ñ€Ð¾Ñ„Ñ–Ð»Ñ–",
    restart:"ÐŸÑ€Ð¾Ð¹Ñ‚Ð¸ Ñ‚ÐµÑÑ‚ Ñ‰Ðµ Ñ€Ð°Ð·",
    slots:"Ð›Ð¾ÐºÐ°Ð»ÑŒÐ½Ñ– ÑÐ»Ð¾Ñ‚Ð¸ Ð¾Ð½Ð¾Ð²Ð»ÑŽÑŽÑ‚ÑŒÑÑ Ð² Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¼Ñƒ Ñ‡Ð°ÑÑ– â€” Ð¼Ð¾Ð¶ÑƒÑ‚ÑŒ Ð·Ð°ÐºÑ–Ð½Ñ‡Ð¸Ñ‚Ð¸ÑÑ",
    male:"Ð¯ â€” Ñ‡Ð¾Ð»Ð¾Ð²Ñ–Ðº", female:"Ð¯ â€” Ð¶Ñ–Ð½ÐºÐ°",
    seek_men:"Ð¨ÑƒÐºÐ°ÑŽ Ñ‡Ð¾Ð»Ð¾Ð²Ñ–ÐºÑ–Ð²", seek_women:"Ð¨ÑƒÐºÐ°ÑŽ Ð¶Ñ–Ð½Ð¾Ðº", seek_both:"ÐžÐ±Ð¾Ñ…", seek_notsay:"Ð’Ð°Ð¶ÐºÐ¾ ÑÐºÐ°Ð·Ð°Ñ‚Ð¸",
    goal_serious:"Ð¡ÐµÑ€Ð¹Ð¾Ð·Ð½Ñ– ÑÑ‚Ð¾ÑÑƒÐ½ÐºÐ¸", goal_casual:"ÐÐµÑ„Ð¾Ñ€Ð¼Ð°Ð»ÑŒÐ½Ñ– Ð¿Ð¾Ð±Ð°Ñ‡ÐµÐ½Ð½Ñ", goal_friend:"Ð”Ñ€ÑƒÐ¶Ð±Ð°", goal_und:"ÐÐµ Ð²Ð¸Ð·Ð½Ð°Ñ‡Ð¸Ð²ÑÑ",
    footer:"Ð†Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ñ–Ð¹Ð½Ð¸Ð¹/Ñ€Ð¾Ð·Ð²Ð°Ð¶Ð°Ð»ÑŒÐ½Ð¸Ð¹ ÐºÐ¾Ð½Ñ‚ÐµÐ½Ñ‚. Ð‘ÐµÐ· Ð²Ñ–Ð´Ð²ÐµÑ€Ñ‚Ð¸Ñ… Ð¼Ð°Ñ‚ÐµÑ€Ñ–Ð°Ð»Ñ–Ð². ÐŸÑ€Ð¾Ð´Ð¾Ð²Ð¶ÑƒÑŽÑ‡Ð¸, Ð²Ð¸ Ð¿Ð¾Ð³Ð¾Ð´Ð¶ÑƒÑ”Ñ‚ÐµÑÑŒ Ñ–Ð· Ð½Ð°ÑˆÐ¸Ð¼Ð¸ ÑƒÐ¼Ð¾Ð²Ð°Ð¼Ð¸."
  }
};

/* Init */
detectLocation();
updateUI();

/* Quiz flow */
function choose(key,value){
  state[key]=value;
  try{ localStorage.setItem('quizDating', JSON.stringify(state)); }catch(e){}
  next();
}
function next(){
  if(state.step===1){ state.step=2; }
  else if(state.step===2){ state.step=3; }
  else if(state.step===3){ state.step=4; }
  else if(state.step===4){ state.step=5; startScan(); }
  updateUI();
}
function restart(){
  state.gender=state.seeking=state.age=state.goal=null;
  state.step=1; updateUI(true);
}

/* UI */
function updateUI(resetImg){
  const percent = Math.min(Math.round((state.step-1)/state.total*100), 100);
  el('#bar').style.width = percent + '%';

  const where = prettyLoc();
  const t = L[state.lang] || L.en;
  setText('#i_badge', t.badge);
  setText('#title', t.t1(where));
  setText('#subtitle', t.s1(where));
  setText('#i_scanning', t.scanning);
  setText('#i_scan_sub', t.scanSub(where));
  setText('#i_found', t.found(where));
  setText('#i_b1', t.b1); setText('#i_b2', t.b2); setText('#i_b3', t.b3);
  setText('#i_cta', t.cta); setText('#i_restart', t.restart); setText('#i_slots', t.slots);
  setText('#b_male', t.male); setText('#b_female', t.female);
  setText('#b_seek_men', t.seek_men); setText('#b_seek_women', t.seek_women); setText('#b_seek_both', t.seek_both); setText('#b_seek_notsay', t.seek_notsay);
  setText('#b_goal_serious', t.goal_serious); setText('#b_goal_casual', t.goal_casual); setText('#b_goal_friend', t.goal_friend); setText('#b_goal_undecided', t.goal_und);

  setText('#loc-inline', where || (state.lang==='pt'?'vocÃª':'you'));
  setText('#loc-sub', where || (state.lang==='pt'?'sua regiÃ£o':'your area'));
  setText('#loc-scan', where || (state.lang==='pt'?'vocÃª':'you'));
  setText('#loc-result', where || (state.lang==='pt'?'sua regiÃ£o':'your area'));

  /* step titles text swap for steps 2-4 */
  if(state.step===2){ setText('#title', t.t2); setText('#subtitle', t.s2); }
  if(state.step===3){ setText('#title', t.t3); setText('#subtitle', t.s3); }
  if(state.step===4){ setText('#title', t.t4); setText('#subtitle', t.s4); }

  if(resetImg!==false){
    const img = (state.step>=5) ? 'https://i.ibb.co/zV1xhvN/chat-sedutor.jpg' : 'https://i.ibb.co/3sZ9dXx/casal-feliz.jpg';
    el('#qimg').src = img;
  }

  ['#step1','#step2','#step3','#step4','#scan','#result'].forEach(id=>hide(id));
  if(state.step===1) show('#step1');
  if(state.step===2) show('#step2');
  if(state.step===3) show('#step3');
  if(state.step===4) show('#step4');
  if(state.step===5) show('#scan');
  if(state.step===6){
    const parts = [];
    if(state.gender) parts.push( state.lang==='pt' ? `VocÃª Ã© ${translateGender(state.gender,'pt')}` : `You are ${state.gender.toLowerCase()}` );
    if(state.seeking && state.seeking!=='Prefer not to say') parts.push( state.lang==='pt' ? `procura ${translateSeeking(state.seeking,'pt')}` : `looking for ${state.seeking.toLowerCase()}` );
    if(state.age) parts.push( (state.lang==='pt' ? 'na faixa ' : 'in the range ') + state.age );
    if(state.goal && state.goal!=='Undecided') parts.push( (state.lang==='pt' ? 'para ' : 'for ') + (state.goal.toLowerCase()) );
    if(where) parts.push( (state.lang==='pt' ? 'em ' : 'in ') + where );
    el('#summary').textContent = parts.length ? parts.join(', ') + '.' : (state.lang==='pt' ? 'Baseado nas suas respostas, selecionamos pessoas que combinam com vocÃª.' : 'Based on your answers, we selected people that match you.');

    // CTA with UTM + geo + quiz params
    const base = 'SUA_URL_AQUI';
    const url = new URL(base, location.href);
    url.searchParams.set('utm_source', detectSource());
    url.searchParams.set('utm_campaign','quiz_compatibility');
    url.searchParams.set('g', state.gender||'');
    url.searchParams.set('s', state.seeking||'');
    url.searchParams.set('a', state.age||'');
    url.searchParams.set('goal', state.goal||'');
    if(state.city) url.searchParams.set('loc_city', state.city);
    if(state.region) url.searchParams.set('loc_region', state.region);
    if(state.country) url.searchParams.set('loc_country', state.country);
    if(state.cc) url.searchParams.set('cc', state.cc);
    el('#cta').href = url.toString();

    show('#result');
  }
}
function startScan(){
  let pct = 0;
  const status = el('#scanStatus');
  const timer = setInterval(()=>{
    pct += Math.floor(Math.random()*17)+6;
    if(pct>100) pct=100;
    status.textContent = (state.lang==='pt'?'Procurando compatibilidadesâ€¦ ':'Searching matchesâ€¦ ') + pct + '%';
    if(pct>=100){
      clearInterval(timer);
      setTimeout(()=>{ state.step=6; updateUI(false); }, 400);
    }
  }, 450);
}

/* Helpers */
function setText(sel, val){ const n = el(sel); if(n) n.textContent = val; }
function prettyLoc(){
  if(state.city && state.region){ return `${state.city}/${state.region}`; }
  if(state.city && state.country){ return `${state.city}, ${state.country}`; }
  if(state.region && state.country){ return `${state.region}, ${state.country}`; }
  if(state.country){ return state.country; }
  return '';
}
function translateGender(v,lang){ if(lang!=='pt') return v; return v==='Male'?'homem': v==='Female'?'mulher': v }
function translateSeeking(v,lang){ if(lang!=='pt') return v; return v==='Men'?'homens': v==='Women'?'mulheres': v==='Both'?'ambos':'â€”' }
function detectSource(){
  const r = document.referrer.toLowerCase();
  if(r.includes('facebook')) return 'facebook';
  if(r.includes('taboola')) return 'taboola';
  return 'native';
}

/* ========================
   GEOLOCATION + AUTOLANG
======================== */
async function detectLocation(){
  try{
    const d = await fetch('https://ipapi.co/json/').then(r=>r.ok?r.json():Promise.reject());
    if(d){
      state.city = d.city || null;
      state.region = (d.region_code || d.region || '').replace('State of ','') || null;
      state.country = d.country_name || d.country || null;
      state.cc = d.country || null; // ISO-CC
      chooseLangByCC(state.cc);
      updateUI(false);
      return;
    }
  }catch(e){}
  try{
    const d = await fetch('https://ipwho.is/').then(r=>r.ok?r.json():Promise.reject());
    if(d && d.success!==false){
      state.city = d.city || null;
      state.region = d.region || null;
      state.country = d.country || null;
      state.cc = d.country_code || null;
      chooseLangByCC(state.cc);
      updateUI(false);
      return;
    }
  }catch(e){}
  // fallback: keep EN/PT based on <html lang>
  const docLang = (document.documentElement.getAttribute('lang')||'en').slice(0,2);
  state.lang = ['pt','da','nb','uk','en'].includes(docLang)?docLang:'en';
  updateUI(false);
}

function chooseLangByCC(cc){
  cc = (cc||'').toUpperCase();
  if(cc==='DK'){ state.lang='da'; }
  else if(cc==='NO'){ state.lang='nb'; }
  else if(cc==='UA'){ state.lang='uk'; }
  else if(cc==='BR' || cc==='PT'){ state.lang='pt'; }
  else { state.lang='en'; }
}
</script>

<!-- Pixel (opcional) 
<script>
  // exemplo de marcaÃ§Ã£o de evento no clique do CTA:
  document.addEventListener('DOMContentLoaded', ()=>{
    const cta = document.getElementById('cta');
    cta.addEventListener('click', ()=>{
      try{ fbq && fbq('trackCustom','QuizCTA'); }catch(e){}
    });
  });
</script>
-->
</body>
</html>
